const t=t=>("#"===t[0]&&(t=t.substr(1)),t.length<6?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16)}:{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16)}),e=t=>{const{h:e,s:o,l:s}=(({h:t,s:e,v:o})=>{const s=(200-e)*o/100;return{h:t,s:s>0&&s<200?e*o/100/(s<=100?s:200-s)*100:0,l:s/2}})(t);return`hsl(${e}, ${o}%, ${s}%)`},o=({h:t,s:e,v:o})=>{t=t/360*6,e/=100,o/=100;const s=Math.floor(t),n=o*(1-e),r=o*(1-(t-s)*e),i=o*(1-(1-t+s)*e),c=s%6;return{r:Math.round(255*[o,r,n,n,i,o][c]),g:Math.round(255*[i,o,o,r,n,n][c]),b:Math.round(255*[n,n,i,o,o,r][c])}},s=t=>{const e=t.toString(16);return e.length<2?"0"+e:e},n=({r:t,g:e,b:o})=>"#"+s(t)+s(e)+s(o),r=({r:t,g:e,b:o})=>{const s=Math.max(t,e,o),n=s-Math.min(t,e,o),r=n?s===t?(e-o)/n:s===e?2+(o-t)/n:4+(t-e)/n:0;return{h:Math.round(60*(r<0?r+6:r)),s:Math.round(s?n/s*100:0),v:Math.round(s/255*100)}},i=(t,e)=>{if(t===e)return!0;for(const o in t)if(t[o]!==e[o])return!1;return!0},c=t=>{const e=document.createElement("template");return e.innerHTML=t,e},h=(t,e)=>{const o=t.shadowRoot||t.attachShadow({mode:"open"});return o.appendChild(e.content.cloneNode(!0)),o};const l=t=>t>1?1:t<0?0:t,a=c('\n<style>#interactive{position:absolute;left:0;top:0;width:100%;height:100%;touch-action:none;user-select:none;-webkit-user-select:none}[part=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:24px;height:24px;transform:translate(-50%, -50%);border:2px solid #fff;border-radius:50%;box-shadow:0 2px 3px rgba(0,0,0,.2)}</style>\n<div id="interactive"><div part="pointer"></div></div>\n'),u=(t,e)=>{const o=e instanceof MouseEvent?e:e.touches[0];return{left:l((o.pageX-(t.left+window.pageXOffset))/t.width),top:l((o.pageY-(t.top+window.pageYOffset))/t.height)}};class d extends HTMLElement{constructor(){super(),this.pointer=h(this,a).querySelector("[part=pointer]").style,this.addEventListener("mousedown",this),this.addEventListener("touchstart",this)}set dragging(t){const e=t?document.addEventListener:document.removeEventListener;e("mousemove",this),e("touchmove",this),e("mouseup",this),e("touchend",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t instanceof MouseEvent&&0!==t.button)return;this.onMove(t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),this.onMove(t);break;case"mouseup":case"touchend":this.dragging=!1}}onMove(t){this.dispatchEvent(new CustomEvent("move",{bubbles:!0,detail:this.getMove(u(this.getBoundingClientRect(),t))}))}setStyles(t){for(const e in t)this.pointer.setProperty(e,t[e])}}const p=c("<style>:host{position:absolute;bottom:0;left:0;right:0;height:20px;border-radius:0 0 8px 8px;background:linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)}[part=pointer]{top:50%}</style>");customElements.define("vc-hue",class extends d{constructor(){super(),h(this,p)}connectedCallback(){if(this.hasOwnProperty("hue")){const t=this.hue;delete this.hue,this.hue=t}}set hue(t){this.setStyles({left:t/360*100+"%","background-color":e({h:t,s:100,v:100})})}getMove(t){return{h:360*t.left}}});const v=c('<style>:host{display:block;position:absolute;top:0;left:0;right:0;bottom:20px;border-bottom:10px solid #000;border-radius:8px 8px 0 0}:host::after,:host::before{content:"";position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;border-radius:inherit}:host::before{background:linear-gradient(to right, #fff, rgba(255, 255, 255, 0))}:host::after{background:linear-gradient(to top, #000, rgba(0, 0, 0, 0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}</style>');customElements.define("vc-saturation",class extends d{constructor(){super(),h(this,v)}connectedCallback(){if(this.hasOwnProperty("hsv")){const t=this.hsv;delete this.hsv,this.hsv=t}}set hsv(t){this.style.backgroundColor=e({h:t.h,s:100,v:100}),this.setStyles({top:100-t.v+"%",left:t.s+"%","background-color":e(t)})}getMove(t){return{s:100*t.left,v:Math.round(100-100*t.top)}}});const f=c('\n<style>:host{display:block;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}</style>\n<vc-saturation part="saturation" exportparts="pointer: saturation-pointer"></vc-saturation>\n<vc-hue part="hue" exportparts="pointer: hue-pointer"></vc-hue>\n');class g extends HTMLElement{constructor(){super();const t=h(this,f);t.addEventListener("move",this),this._s=t.children[1],this._h=t.children[2]}static get observedAttributes(){return["color"]}get color(){return this._color}set color(t){if(!this._isSame(t)){const e=this.colorModel.toHsv(t);this._render(e),this._change(t,e)}}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,e,o){const s=this.colorModel.fromAttr(o);this._isSame(s)||(this.color=s)}handleEvent(t){const e=Object.assign({},this._hsv,t.detail);let o;this._render(e),i(e,this._hsv)||this._isSame(o=this.colorModel.fromHsv(e))||this._change(o,e)}_isSame(t){return this.color&&this.colorModel.equal(t,this.color)}_render(t){this._s.hsv=t,this._h.hue=t.h}_change(t,e){this._color=t,this._hsv=e,this.dispatchEvent(new CustomEvent("color-changed",{detail:{value:t}}))}}const b={defaultColor:"#000",toHsv:e=>r(t(e)),fromHsv:t=>n(o(t)),equal:(e,o)=>e.toLowerCase()===o.toLowerCase()||i(t(e),t(o)),fromAttr:t=>t};class m extends g{get colorModel(){return b}}customElements.define("color-picker-hex",class extends m{});const x=/^#?[0-9A-F]{3}$/i,w=/^#?[0-9A-F]{6}$/i,y=t=>w.test(t)||x.test(t),E=t=>t.replace(/([^0-9A-F]+)/gi,"");class _ extends HTMLElement{static get observedAttributes(){return["color"]}get color(){return this._color}set color(t){this._color=t,this._setValue(t)}connectedCallback(){let t=this.querySelector("input");if(t||(t=document.createElement("input"),t.setAttribute("spellcheck","false"),t.setAttribute("maxlength","6"),this.appendChild(t)),t.addEventListener("input",this),t.addEventListener("blur",this),this._input=t,this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else null==this.color?this.color=this.getAttribute("color")||"":this._color&&this._setValue(this._color)}handleEvent(t){const e=t.target,{value:o}=e;switch(t.type){case"input":const t=E(o);this._oldColor=this.color,y(t)&&(this.color=t,this.dispatchEvent(new CustomEvent("color-changed",{detail:{value:"#"+t}})));break;case"blur":y(o)||(this.color=this._oldColor)}}attributeChangedCallback(t,e,o){this.color!==o&&(this.color=o)}_setValue(t){this._input&&(this._input.value=null==t||""==t?"":E(t))}}customElements.define("hex-input",class extends _{});const M=()=>{const t=document.createElement("canvas");return t.width=64,t.height=64,t};let C,k,L;const S=t=>(k||(k=M(),L=(()=>{const t=M(),e=t.getContext("2d");return e.beginPath(),e.arc(32,32,28,0,2*Math.PI,!1),e.closePath(),e.shadowColor="rgba(0, 0, 0, 0.4)",e.shadowOffsetY=1,e.shadowBlur=6,e.fillStyle="#fff",e.fill(),t})()),function(t,e,o,s){var n,r=!1,i=0;function c(){n&&clearTimeout(n)}function h(){for(var h=arguments.length,l=new Array(h),a=0;a<h;a++)l[a]=arguments[a];var u=this,d=Date.now()-i;function p(){i=Date.now(),o.apply(u,l)}function v(){n=void 0}r||(s&&!n&&p(),c(),void 0===s&&d>t?p():!0!==e&&(n=setTimeout(s?v:p,void 0===s?t-d:t)))}return"boolean"!=typeof e&&(s=o,o=e,e=void 0),h.cancel=function(){c(),r=!0},h}(500,()=>{if(!(window.innerWidth<768&&C)){const e=k.getContext("2d");e.clearRect(0,0,64,64),e.drawImage(L,0,0),e.beginPath(),e.arc(32,32,22,0,2*Math.PI,!1),e.closePath(),e.fillStyle=t,e.fill();const o=document.createElement("link");o.rel="shortcut icon",o.href=k.toDataURL("image/x-icon"),C&&document.head.removeChild(C),document.head.appendChild(o),C=o}})),P=document.querySelector("color-picker-hex"),A=document.querySelector("hex-input"),I=P.color;A.color=I,S(I)();const H=e=>{document.body.style.backgroundColor=e;const o=(({r:t,g:e,b:o})=>(299*t+587*e+114*o)/1e3)(t(e))<128?"#fff":"#000";document.body.style.setProperty("--contrast",o),S(e)()};P.addEventListener("color-changed",t=>{const e=t.detail.value;A.color=e,H(e)}),A.addEventListener("color-changed",t=>{const e=t.detail.value;P.color=e,H(e)});
